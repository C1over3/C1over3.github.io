<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.11.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="这个少年还在迷茫...">
<meta property="og:type" content="website">
<meta property="og:title" content="Clover&#39;s blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Clover&#39;s blog">
<meta property="og:description" content="这个少年还在迷茫...">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Clover">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Clover's blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Clover's blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">什么，您是哪里来的闯入者？</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Clover"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Clover</p>
  <div class="site-description" itemprop="description">这个少年还在迷茫...</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/26/nowcoder-24/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/26/nowcoder-24/" class="post-title-link" itemprop="url">牛客网Verilog刷题笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-04-26 18:12:24 / 修改时间：18:13:56" itemprop="dateCreated datePublished" datetime="2022-04-26T18:12:24+08:00">2022-04-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="VL24-边沿检测"><a href="#VL24-边沿检测" class="headerlink" title="VL24 边沿检测"></a><strong>VL24</strong> <strong>边沿检测</strong></h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns/1ns</span></span><br><span class="line"><span class="keyword">module</span> edge_detect(</span><br><span class="line">	<span class="keyword">input</span> clk,</span><br><span class="line">	<span class="keyword">input</span> rst_n,</span><br><span class="line">	<span class="keyword">input</span> a,</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> rise,</span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> down</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">reg</span> past;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(~rst_n)</span><br><span class="line">            past &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            past &lt;= a;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(~rst_n) <span class="keyword">begin</span></span><br><span class="line">            rise &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">            down &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            rise &lt;= ((~past &amp; a) === <span class="number">1&#x27;b1</span>)? <span class="number">1</span> : <span class="number">0</span>;		<span class="comment">//使用全等于，避免未知态带来的影响</span></span><br><span class="line">            down &lt;= ((past &amp; ~a) === <span class="number">1&#x27;b1</span>)? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>


          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/26/nowcoder-24/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/24/note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/24/note/" class="post-title-link" itemprop="url">note</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-04-24 16:20:24 / 修改时间：22:01:41" itemprop="dateCreated datePublished" datetime="2022-04-24T16:20:24+08:00">2022-04-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>常用TestBench</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1 ns/1 ns</span></span><br><span class="line"><span class="meta">`<span class="keyword">define</span> clk_period 20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> test();</span><br><span class="line">    <span class="comment">//reg input ports</span></span><br><span class="line">    <span class="keyword">reg</span> clk;</span><br><span class="line">    <span class="keyword">reg</span> rst_n;</span><br><span class="line">    <span class="comment">//wire output ports</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        clk = <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">forever</span> <span class="variable">#(clk_period/2)</span> clk = ~clk;</span><br><span class="line">        <span class="keyword">repeat</span>(<span class="number">100</span>) <span class="variable">#(clk_period/2)</span> clk = ~clk;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        rst_n = <span class="number">1&#x27;b0</span>;</span><br><span class="line">        #<span class="variable">#(clk_period*2)</span> rst_n = <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<h3 id="VL9-使用子模块实现三输入数的大小比较"><a href="#VL9-使用子模块实现三输入数的大小比较" class="headerlink" title="VL9 使用子模块实现三输入数的大小比较"></a><strong>VL9</strong> <strong>使用子模块实现三输入数的大小比较</strong></h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns/1ns</span></span><br><span class="line"><span class="keyword">module</span> main_mod(</span><br><span class="line">	<span class="keyword">input</span> clk,</span><br><span class="line">	<span class="keyword">input</span> rst_n,</span><br><span class="line">	<span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>]a,</span><br><span class="line">	<span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>]b,</span><br><span class="line">	<span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>]c,</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>]d</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] mid;</span><br><span class="line">    compare C_a_b(</span><br><span class="line">        <span class="variable">.clk</span>(clk), </span><br><span class="line">        <span class="variable">.rst_n</span>(rst_n), </span><br><span class="line">        <span class="variable">.a</span>(a), </span><br><span class="line">        <span class="variable">.b</span>(b), </span><br><span class="line">        <span class="variable">.c</span>(mid)</span><br><span class="line">    );</span><br><span class="line">    compare C_mid_c(</span><br><span class="line">        <span class="variable">.clk</span>(clk), </span><br><span class="line">        <span class="variable">.rst_n</span>(rst_n), </span><br><span class="line">        <span class="variable">.a</span>(mid), </span><br><span class="line">        <span class="variable">.b</span>(c), </span><br><span class="line">        <span class="variable">.c</span>(d)</span><br><span class="line">    );</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> compare(clk, rst_n, a, b, c);</span><br><span class="line">    <span class="keyword">input</span> clk;</span><br><span class="line">    <span class="keyword">input</span> rst_n;</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] a;</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] b;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] c;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span>@(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(~rst_n) </span><br><span class="line">            c &lt;= <span class="number">8&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a &lt; b)</span><br><span class="line">            c &lt;= a;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            c &lt;= b;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>testbench</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns/1ns</span></span><br><span class="line"><span class="meta">`<span class="keyword">define</span> clk_period 2</span></span><br><span class="line"><span class="keyword">module</span> test();</span><br><span class="line">	<span class="keyword">reg</span> <span class="keyword">signed</span> [<span class="number">7</span>:<span class="number">0</span>] a,b,c;</span><br><span class="line">	<span class="keyword">reg</span> clk,rst_n;</span><br><span class="line">	<span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>]d;</span><br><span class="line"><span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">	<span class="built_in">$dumpfile</span>(<span class="string">&quot;out.vcd&quot;</span>);</span><br><span class="line">    <span class="built_in">$dumpvars</span>(<span class="number">0</span>, testbench);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">main_mod dut(</span><br><span class="line">	<span class="variable">.clk</span>(clk),</span><br><span class="line">	<span class="variable">.rst_n</span>(rst_n),</span><br><span class="line">	<span class="variable">.a</span>(a),</span><br><span class="line">	<span class="variable">.b</span>(b),</span><br><span class="line">	<span class="variable">.c</span>(c),</span><br><span class="line">	<span class="variable">.d</span>(d)</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        clk = <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="keyword">repeat</span>(<span class="number">100</span>) <span class="variable">#(`clk_period/2)</span> clk = ~clk;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        rst_n = <span class="number">1&#x27;b0</span>;</span><br><span class="line">        a = <span class="number">8&#x27;h11</span>;</span><br><span class="line">        b = <span class="number">8&#x27;h22</span>;</span><br><span class="line">        c = <span class="number">8&#x27;h33</span>;</span><br><span class="line">        <span class="variable">#(`clk_period*2)</span> rst_n = <span class="number">1&#x27;b1</span>;</span><br><span class="line">        <span class="variable">#(`clk_period*5)</span> a = <span class="number">8&#x27;h16</span>; b = <span class="number">8&#x27;h07</span>; c = <span class="number">8&#x27;h33</span>;</span><br><span class="line">        <span class="variable">#(`clk_period*5)</span> a = <span class="number">8&#x27;h09</span>; b = <span class="number">8&#x27;h22</span>; c = <span class="number">8&#x27;h33</span>;</span><br><span class="line">        <span class="variable">#(`clk_period*5)</span> a = <span class="number">8&#x27;h11</span>; b = <span class="number">8&#x27;h11</span>; c = <span class="number">8&#x27;h55</span>;</span><br><span class="line">        <span class="variable">#(`clk_period*5)</span> a = <span class="number">8&#x27;hab</span>; b = <span class="number">8&#x27;h36</span>; c = <span class="number">8&#x27;h90</span>;</span><br><span class="line">        <span class="variable">#(`clk_period*5)</span> a = <span class="number">8&#x27;h09</span>; b = <span class="number">8&#x27;h27</span>; c = <span class="number">8&#x27;h30</span>;</span><br><span class="line">        <span class="variable">#(`clk_period*5)</span> <span class="built_in">$stop</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>


          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/24/note/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/23/cpp-note-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/23/cpp-note-4/" class="post-title-link" itemprop="url">C++笔记（四）——自定义数据结构</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-23 20:58:08" itemprop="dateCreated datePublished" datetime="2022-04-23T20:58:08+08:00">2022-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-26 23:55:48" itemprop="dateModified" datetime="2022-04-26T23:55:48+08:00">2022-04-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="自定义数据结构"><a href="#自定义数据结构" class="headerlink" title="自定义数据结构"></a>自定义数据结构</h1><p>数据结构是把一组相关的数据元素组织起来然后使用它们的策略和方法，如Sales_item类，把书本的ISBN编号、售出量和销售收入等数据组织在了一起，并且提供如isbn函数、&gt;&gt;、&lt;&lt;、+、+&#x3D;等运算在内的一系列操作，Sales_item类就是一个数据结构。</p>
<p>C++允许用户以类的形式自定义数据类型。</p>
<h2 id="定义Sales-data类型"><a href="#定义Sales-data类型" class="headerlink" title="定义Sales_data类型"></a>定义Sales_data类型</h2><p>在第七章之前，都使用struct（结构体）来自定义数据类型：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Sales_data</span>&#123;</span><br><span class="line">    std::string bookNo;</span><br><span class="line">    <span class="type">unsigned</span> units_sold = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> revenue = <span class="number">0.0</span>;</span><br><span class="line">&#125;;									<span class="comment">//注意：类体右侧的表示结束的花括号后必须写一个分号，因为类体后面可以紧跟变量名以示对该类型对象的定义</span></span><br></pre></td></tr></table></figure>

<p>{}中的三条语句定义了struct的数据成员(data member)，C++11新标准规定，可以为数据成员提供一个类内初始值(in-class initializer)，没有初始值的成员将被默认初始化。</p>
<p><strong>千万牢记，定义数据类型的{}之后一定要有分号，而定义函数的{}之后则不需要分号。</strong></p>
<p>定义该类型的对象：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Sales_data</span>&#123;<span class="comment">/*...*/</span>&#125; accum, trans, *salesptr;</span><br><span class="line"><span class="comment">//以下两条语句等同于上一条语句，但更易读一些</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Sales_data</span>&#123;<span class="comment">/*...*/</span>&#125;;</span><br><span class="line">Sales_data accum, trans, *salesptr;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/23/cpp-note-4/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/23/cpp-note-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/23/cpp-note-3/" class="post-title-link" itemprop="url">C++笔记（三）——处理类型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-23 12:12:45" itemprop="dateCreated datePublished" datetime="2022-04-23T12:12:45+08:00">2022-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-25 22:10:11" itemprop="dateModified" datetime="2022-04-25T22:10:11+08:00">2022-04-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="常量表达式和constexpr"><a href="#常量表达式和constexpr" class="headerlink" title="常量表达式和constexpr"></a>常量表达式和constexpr</h1><h2 id="常量表达式-const-expression"><a href="#常量表达式-const-expression" class="headerlink" title="常量表达式(const expression)"></a>常量表达式(const expression)</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> max_files = <span class="number">20</span>;			<span class="comment">//max_files是常量表达式</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> limit = max_filse + <span class="number">1</span>;	<span class="comment">//limit是常量表达式</span></span><br><span class="line"><span class="type">int</span> staff_size = <span class="number">27</span>;				<span class="comment">//staff_size不是常量表达式</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> sz = <span class="built_in">get_size</span>();			<span class="comment">//sz不是常量表达式，其具体值在程序运行时才能获得，而不是编译时获得</span></span><br></pre></td></tr></table></figure>

<p>在复杂系统中，无法分辨一个初始值到底是不是常量表达式。这种情况下，对象的定义和使用根本就是两回事儿。</p>
<h2 id="constexpr变量"><a href="#constexpr变量" class="headerlink" title="constexpr变量"></a>constexpr变量</h2><p>C++11新标准规定，允许将变量声明为constexpr类型以便由编译器来验证变量的值是否是一个常量表达式。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mf = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> limit = mf + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> sz = <span class="built_in">size</span>();		<span class="comment">//只有当size是一个constexpr函数时，这才是一条正确语句</span></span><br></pre></td></tr></table></figure>

<p>同时C++11新标准也允许定义一种constexpr函数，这种函数必须简单到在编译时就可以计算其结果，这样就能用constexpr函数去初始化constexpr变量。</p>
<p>在声明constexpr时，用到的类型只能是字面值类型</p>
<h2 id="字面值类型-literal-type"><a href="#字面值类型-literal-type" class="headerlink" title="字面值类型(literal type)"></a>字面值类型(literal type)</h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/23/cpp-note-3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/20/cpp-note-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/20/cpp-note-2/" class="post-title-link" itemprop="url">C++笔记（二）——const限定符</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-20 17:47:51" itemprop="dateCreated datePublished" datetime="2022-04-20T17:47:51+08:00">2022-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-23 20:37:31" itemprop="dateModified" datetime="2022-04-23T20:37:31+08:00">2022-04-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="const限定符"><a href="#const限定符" class="headerlink" title="const限定符"></a>const限定符</h1><h2 id="const对象"><a href="#const对象" class="headerlink" title="const对象"></a>const对象</h2><p>const对象一旦创建后其值就不可改变，因此必须初始化；</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> i = <span class="built_in">get_size</span>();	<span class="comment">//正确：运行时初始化，get_size()为有返回值的函数</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> j = <span class="number">42</span>;			<span class="comment">//正确：编译时初始化</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> k;				<span class="comment">//错误：k是一个未经初始化的常量</span></span><br></pre></td></tr></table></figure>
<p>默认状态下，const对象仅在文件内有效，因为编译器将在编译过程中会把用到该变量的地方都替换成对应的值，每个用了const对象的文件都必须含有对它的定义而非声明；<br>如：<br>在test1中</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> i = <span class="number">1</span>;	<span class="comment">//定义全局常量i，初始化为1</span></span><br><span class="line"><span class="type">int</span> j = <span class="number">2</span>;			<span class="comment">//定义全局变量j，初始化为2</span></span><br></pre></td></tr></table></figure>
<p>test2中</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">extern</span> <span class="type">int</span> i;</span><br><span class="line">	cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>test3中</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">extern</span> <span class="type">int</span> j;</span><br><span class="line">	cout &lt;&lt; j &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/20/cpp-note-2/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/18/cpp-note-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/18/cpp-note-1/" class="post-title-link" itemprop="url">C++笔记（一）——变量和复合类型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-18 12:07:01" itemprop="dateCreated datePublished" datetime="2022-04-18T12:07:01+08:00">2022-04-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-23 20:37:05" itemprop="dateModified" datetime="2022-04-23T20:37:05+08:00">2022-04-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="不同初始化方式的区别"><a href="#不同初始化方式的区别" class="headerlink" title="不同初始化方式的区别"></a>不同初始化方式的区别</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">double</span> ld = <span class="number">3.1415926536</span>;</span><br><span class="line">	<span class="type">int</span> a&#123; ld &#125;, b = &#123; ld &#125;;  <span class="comment">//错误：会提示error C2397: 从“long double”转换到“int”需要收缩转换</span></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">c</span><span class="params">(ld)</span>, d </span>= ld;<span class="comment">//能够完成编译，且确实丢失了部分值，c和d输出均为3</span></span><br><span class="line">	cout &lt;&lt; a &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; c &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; d &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于局部变量来说，初始化很重要；在编写某个类的时候，尽量申明当该类的某个对象未被显式初始化时，生成一个合适的默认值。</p>
<h2 id="声明和定义"><a href="#声明和定义" class="headerlink" title="声明和定义"></a>声明和定义</h2><p>C++支持分离式编译(separate compilation)</p>
<p>声明(declaration)：使得某个名字为程序所知，即这个变量已经在别处定义了，我现在拿来用。（声明一个其他地方定义过的全局变量）</p>
<p>定义(definition)：创建与名字关联的实体。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">int</span> i;	<span class="comment">//声明i而非定义i，但如果显式初始化后则会抵消了extern的作用</span></span><br><span class="line"><span class="type">int</span> j;	<span class="comment">//定义j</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">double</span> pi = <span class="number">3.1416</span>;	<span class="comment">//定义pi，且初始化为3.1416</span></span><br></pre></td></tr></table></figure>
<p>在函数内部，如果试图初始化一个由extern关键字标记的变量，将引发错误。</p>
<p>ps: C++是一种静态类型（statically typed）语言，其含义是在编译阶段执行类型检查（type checking）。如果编译器发现数据类型不支持要执行的运算，则会报错且不会生成任何可执行的程序。程序越复杂，静态类型检查越有助于发现问题。这要求我们在使用某个变量之前必须声明其类型。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/18/cpp-note-1/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/17/FPGA-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/17/FPGA-4/" class="post-title-link" itemprop="url">学习FPGA（四）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-17 10:57:24" itemprop="dateCreated datePublished" datetime="2022-04-17T10:57:24+08:00">2022-04-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-26 16:09:33" itemprop="dateModified" datetime="2022-04-26T16:09:33+08:00">2022-04-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="实现FPGA驱动数码管动态显示"><a href="#实现FPGA驱动数码管动态显示" class="headerlink" title="实现FPGA驱动数码管动态显示"></a>实现FPGA驱动数码管动态显示</h1><p>知识点：</p>
<ol>
<li>数码管动态扫描实现。</li>
<li>In system sources and probes editor (ISSP)调试工具的使用。</li>
</ol>
<h2 id="工程代码"><a href="#工程代码" class="headerlink" title="工程代码"></a>工程代码</h2><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现FPGA驱动数码管动态显示</span></span><br><span class="line"><span class="keyword">module</span> digital_display(Clk, Rst_n, En, disp_data, sel, seg);</span><br><span class="line">	<span class="keyword">input</span> Clk;					<span class="comment">//50M，一个周期为20ns</span></span><br><span class="line">	<span class="keyword">input</span> Rst_n;</span><br><span class="line">	<span class="keyword">input</span> En;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] disp_data;	<span class="comment">//输入要求显示的内容</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] sel;			<span class="comment">//数码管位选（当前要显示的数码管）</span></span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">6</span>:<span class="number">0</span>] seg;			<span class="comment">//数码管段选（当前要显示的内容）</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//divider module</span></span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">14</span>:<span class="number">0</span>] divider_cnt;	<span class="comment">//产生1ms的时钟，每0.5ms时钟信号需要翻转一次，0.5ms/20ns=25_000=16&#x27;b0110_0001_1010_1000，故需要15位计数器</span></span><br><span class="line">	<span class="keyword">reg</span> Clk_1K;</span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(~Rst_n) </span><br><span class="line">			divider_cnt &lt;= <span class="number">15&#x27;d0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(~En) </span><br><span class="line">			divider_cnt &lt;= <span class="number">15&#x27;d0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(divider_cnt== <span class="number">15&#x27;d24_999</span>) </span><br><span class="line">			divider_cnt &lt;= <span class="number">15&#x27;d0</span>;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			divider_cnt &lt;= divider_cnt + <span class="number">1&#x27;b1</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(~Rst_n) </span><br><span class="line">			Clk_1K &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(~En) </span><br><span class="line">			Clk_1K &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(divider_cnt== <span class="number">15&#x27;d24_999</span>) </span><br><span class="line">			Clk_1K &lt;= ~Clk_1K;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			Clk_1K &lt;= Clk_1K;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	<span class="comment">//shift8 module</span></span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] sel_r;</span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk_1K <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span>	<span class="comment">//注意，分频器的输出信号作为D触发器的时钟信号，在大型设计中是不被允许的，此处设计为数码管驱动模块，影响不大，允许存在这样的毛刺</span></span><br><span class="line">		<span class="keyword">if</span>(~Rst_n)</span><br><span class="line">			sel_r &lt;= <span class="number">8&#x27;b0000_0001</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(sel_r == <span class="number">8&#x27;b1000_0000</span>)</span><br><span class="line">			sel_r &lt;= <span class="number">8&#x27;b0000_0001</span>;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			sel_r &lt;= &#123;sel_r[<span class="number">6</span>:<span class="number">0</span>],<span class="number">1&#x27;b0</span>&#125;;	<span class="comment">//此句也可改为	sel_r &lt;= sel_r &lt;&lt; 1;</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//MUX8 (combitional)</span></span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] data_tmp;</span><br><span class="line">	<span class="keyword">always</span>@(*) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">case</span>(sel_r)</span><br><span class="line">			<span class="number">8&#x27;b0000_0001</span>: data_tmp = disp_data[<span class="number">3</span>:<span class="number">0</span>];</span><br><span class="line">			<span class="number">8&#x27;b0000_0010</span>: data_tmp = disp_data[<span class="number">7</span>:<span class="number">4</span>];</span><br><span class="line">			<span class="number">8&#x27;b0000_0100</span>: data_tmp = disp_data[<span class="number">11</span>:<span class="number">8</span>];</span><br><span class="line">			<span class="number">8&#x27;b0000_1000</span>: data_tmp = disp_data[<span class="number">15</span>:<span class="number">12</span>];</span><br><span class="line">			</span><br><span class="line">			<span class="number">8&#x27;b0001_0000</span>: data_tmp = disp_data[<span class="number">19</span>:<span class="number">16</span>];</span><br><span class="line">			<span class="number">8&#x27;b0010_0000</span>: data_tmp = disp_data[<span class="number">23</span>:<span class="number">20</span>];</span><br><span class="line">			<span class="number">8&#x27;b0100_0000</span>: data_tmp = disp_data[<span class="number">27</span>:<span class="number">24</span>];</span><br><span class="line">			<span class="number">8&#x27;b1000_0000</span>: data_tmp = disp_data[<span class="number">31</span>:<span class="number">28</span>];</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">default</span>: data_tmp = <span class="number">4&#x27;b0000</span>;</span><br><span class="line">		<span class="keyword">endcase</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//MUX2 (combitional)</span></span><br><span class="line">	<span class="keyword">always</span>@(*) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(~En)</span><br><span class="line">			sel = <span class="number">8&#x27;b0000_0000</span>;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			sel = sel_r;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//LUT (combitional)</span></span><br><span class="line">	<span class="comment">//注意：数码管灯段在输入为0时亮起，输入为1时熄灭；</span></span><br><span class="line">	<span class="comment">//h段为最高位，a段为最低位；</span></span><br><span class="line">	<span class="keyword">always</span>@(*) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">case</span>(data_tmp)</span><br><span class="line">			<span class="number">4&#x27;b0000</span>: seg = <span class="number">7&#x27;b100_0000</span>;	<span class="comment">//0</span></span><br><span class="line">			<span class="number">4&#x27;b0001</span>: seg = <span class="number">7&#x27;b111_1001</span>;	<span class="comment">//1</span></span><br><span class="line">			<span class="number">4&#x27;b0010</span>: seg = <span class="number">7&#x27;b010_0100</span>;	<span class="comment">//2</span></span><br><span class="line">			<span class="number">4&#x27;b0011</span>: seg = <span class="number">7&#x27;b011_0000</span>;	<span class="comment">//3</span></span><br><span class="line">			</span><br><span class="line">			<span class="number">4&#x27;b0100</span>: seg = <span class="number">7&#x27;b001_1001</span>;	<span class="comment">//4</span></span><br><span class="line">			<span class="number">4&#x27;b0101</span>: seg = <span class="number">7&#x27;b001_0010</span>;	<span class="comment">//5</span></span><br><span class="line">			<span class="number">4&#x27;b0110</span>: seg = <span class="number">7&#x27;b000_0010</span>;	<span class="comment">//6</span></span><br><span class="line">			<span class="number">4&#x27;b0111</span>: seg = <span class="number">7&#x27;b111_1000</span>;	<span class="comment">//7</span></span><br><span class="line">			</span><br><span class="line">			<span class="number">4&#x27;b1000</span>: seg = <span class="number">7&#x27;b000_0000</span>;	<span class="comment">//8</span></span><br><span class="line">			<span class="number">4&#x27;b1001</span>: seg = <span class="number">7&#x27;b001_0000</span>;	<span class="comment">//9</span></span><br><span class="line">			<span class="number">4&#x27;b1010</span>: seg = <span class="number">7&#x27;b000_1000</span>;	<span class="comment">//a</span></span><br><span class="line">			<span class="number">4&#x27;b1011</span>: seg = <span class="number">7&#x27;b000_0011</span>;	<span class="comment">//b</span></span><br><span class="line">			</span><br><span class="line">			<span class="number">4&#x27;b1100</span>: seg = <span class="number">7&#x27;b100_0110</span>;	<span class="comment">//c</span></span><br><span class="line">			<span class="number">4&#x27;b1101</span>: seg = <span class="number">7&#x27;b010_0001</span>;	<span class="comment">//d</span></span><br><span class="line">			<span class="number">4&#x27;b1110</span>: seg = <span class="number">7&#x27;b000_0110</span>;	<span class="comment">//e</span></span><br><span class="line">			<span class="number">4&#x27;b1111</span>: seg = <span class="number">7&#x27;b000_1110</span>;	<span class="comment">//f</span></span><br><span class="line">			</span><br><span class="line">			<span class="keyword">default</span>: seg = <span class="number">7&#x27;b111_1111</span>;	<span class="comment">//全灭</span></span><br><span class="line">		<span class="keyword">endcase</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span> </span><br></pre></td></tr></table></figure>
<h2 id="TestBench"><a href="#TestBench" class="headerlink" title="TestBench"></a>TestBench</h2><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1 ns/ 1 ps</span></span><br><span class="line"><span class="meta">`<span class="keyword">define</span> clk_period 20</span></span><br><span class="line"><span class="keyword">module</span> digital_display_vlg_tst();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">reg</span> Clk;</span><br><span class="line">	<span class="keyword">reg</span> En;</span><br><span class="line">	<span class="keyword">reg</span> Rst_n;</span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] disp_data;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">wire</span> [<span class="number">6</span>:<span class="number">0</span>]  seg;</span><br><span class="line">	<span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>]  sel;</span><br><span class="line"></span><br><span class="line">	digital_display u1 (</span><br><span class="line">		<span class="variable">.Clk</span>(Clk),</span><br><span class="line">		<span class="variable">.En</span>(En),</span><br><span class="line">		<span class="variable">.Rst_n</span>(Rst_n),</span><br><span class="line">		<span class="variable">.disp_data</span>(disp_data),</span><br><span class="line">		<span class="variable">.seg</span>(seg),</span><br><span class="line">		<span class="variable">.sel</span>(sel)</span><br><span class="line">	);</span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		Clk = <span class="number">1&#x27;b1</span>;</span><br><span class="line">		<span class="keyword">forever</span> <span class="variable">#(`clk_period/2)</span> Clk = ~Clk;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		Rst_n = <span class="number">1&#x27;b0</span>;</span><br><span class="line">		En = <span class="number">1&#x27;b1</span>;</span><br><span class="line">		disp_data = <span class="number">32&#x27;h12345678</span>;</span><br><span class="line">		<span class="variable">#(`clk_period*20)</span>;</span><br><span class="line">		Rst_n = <span class="number">1&#x27;b1</span>;</span><br><span class="line">		<span class="variable">#(`clk_period*20)</span>;</span><br><span class="line">		#<span class="number">20_000_000</span>;</span><br><span class="line">		disp_data = <span class="number">32&#x27;h87654321</span>;</span><br><span class="line">		#<span class="number">20_000_000</span>;</span><br><span class="line">		disp_data = <span class="number">32&#x27;h89abcdef</span>;</span><br><span class="line">		#<span class="number">20_000_000</span>;</span><br><span class="line">		<span class="built_in">$stop</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>得到的仿真波形：</p>
<p><img src="C:\Users\91590\AppData\Roaming\Typora\typora-user-images\1650940716028.png" alt="1650940716028"></p>
<h2 id="ISSP"><a href="#ISSP" class="headerlink" title="ISSP"></a>ISSP</h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/17/FPGA-4/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/15/FPGA-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/15/FPGA-3/" class="post-title-link" itemprop="url">学习FPGA（三）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-15 15:39:43" itemprop="dateCreated datePublished" datetime="2022-04-15T15:39:43+08:00">2022-04-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-23 09:31:39" itemprop="dateModified" datetime="2022-04-23T09:31:39+08:00">2022-04-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="按键消抖"><a href="#按键消抖" class="headerlink" title="按键消抖"></a>按键消抖</h1><h2 id="主模块"><a href="#主模块" class="headerlink" title="主模块"></a>主模块</h2><p>三段式状态机代码如下</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//目的：设计一个按键消抖，滤波时间为20ms</span></span><br><span class="line"><span class="comment">//晶振为50M，即一个时间周期为20ns</span></span><br><span class="line"><span class="comment">//需要滤波1_000_000个时间周期</span></span><br><span class="line"><span class="meta">`<span class="keyword">define</span> filter_time 20&#x27;d1_000_000</span></span><br><span class="line"><span class="keyword">module</span> key_filter(Clk, Rst_n, Key_in, Key_flag, Key_state);</span><br><span class="line">	<span class="keyword">input</span> Clk;	<span class="comment">//时钟输入</span></span><br><span class="line">	<span class="keyword">input</span> Rst_n;	<span class="comment">//复位输入</span></span><br><span class="line">	<span class="keyword">input</span> Key_in;	<span class="comment">//按键输入，按下时为0，断开时为1</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> Key_flag;	<span class="comment">//按键输入变化后出现稳定状态时，显示为1（保持一个时钟周期），其余时候为0</span></span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> Key_state;	<span class="comment">//按键状态，按下时显示为0， 断开时为1</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//set state(one-hot code)</span></span><br><span class="line">	<span class="keyword">localparam</span> </span><br><span class="line">		IDLE		= <span class="number">4&#x27;b0001</span>, </span><br><span class="line">		FILTER0	= <span class="number">4&#x27;b0010</span>, </span><br><span class="line">		DOWN		= <span class="number">4&#x27;b0100</span>,</span><br><span class="line">		FILTER1	= <span class="number">4&#x27;b1000</span>;</span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state, next;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//edge check</span></span><br><span class="line">	<span class="keyword">reg</span> Key_tmp0, Key_tmp1;</span><br><span class="line">	<span class="keyword">wire</span> Key_posedge, Key_negedge;</span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(~Rst_n) <span class="keyword">begin</span></span><br><span class="line">			Key_tmp0 &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">			Key_tmp1 &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">			Key_tmp0 &lt;= Key_in;		<span class="comment">//当Key_tmp0 = 1 且 Key_tmp1 = 0时即为一个上升沿</span></span><br><span class="line">			Key_tmp1 &lt;= Key_tmp0;	<span class="comment">//当Key_tmp0 = 0 且 Key_tmp1 = 1时即为一个下降沿</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">assign</span> Key_posedge = ~Key_tmp1 &amp; Key_tmp0;</span><br><span class="line">	<span class="keyword">assign</span> Key_negedge = Key_tmp1 &amp; ~Key_tmp0;</span><br><span class="line">	<span class="comment">//filter counter</span></span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">19</span>:<span class="number">0</span>] cnt;</span><br><span class="line">	<span class="keyword">reg</span> cnt_full;	<span class="comment">//计数器计满信号</span></span><br><span class="line">	<span class="keyword">reg</span> en_cnt;		<span class="comment">//计数器使能信号</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(~Rst_n) <span class="keyword">begin</span></span><br><span class="line">			cnt &lt;= <span class="number">&#x27;d0</span>;</span><br><span class="line">			cnt_full &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(en_cnt) <span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">if</span>(cnt == (`filter_time - <span class="number">1</span>)) <span class="keyword">begin</span></span><br><span class="line">				cnt &lt;= <span class="number">&#x27;d0</span>;</span><br><span class="line">				cnt_full &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">				cnt &lt;= cnt + <span class="number">1&#x27;b1</span>;</span><br><span class="line">				cnt_full &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">			cnt &lt;= <span class="number">&#x27;d0</span>;</span><br><span class="line">			cnt_full &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//state transition(combinational)</span></span><br><span class="line">	<span class="keyword">always</span>@(*) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">case</span>(state)</span><br><span class="line">			IDLE: <span class="keyword">begin</span></span><br><span class="line">				<span class="keyword">if</span>(Key_negedge)</span><br><span class="line">					next = FILTER0;</span><br><span class="line">				<span class="keyword">else</span> </span><br><span class="line">					next = IDLE;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			FILTER0: <span class="keyword">begin</span></span><br><span class="line">				<span class="keyword">if</span>(cnt_full)</span><br><span class="line">					next = DOWN;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(Key_posedge)</span><br><span class="line">					next = IDLE;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					next = FILTER0;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			DOWN: <span class="keyword">begin</span></span><br><span class="line">				<span class="keyword">if</span>(Key_posedge)</span><br><span class="line">					next = FILTER1;</span><br><span class="line">				<span class="keyword">else</span> </span><br><span class="line">					next = DOWN;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			FILTER1: <span class="keyword">begin</span> </span><br><span class="line">				<span class="keyword">if</span>(cnt_full) </span><br><span class="line">					next = IDLE;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(Key_negedge)</span><br><span class="line">					next = DOWN;</span><br><span class="line">				<span class="keyword">else</span> </span><br><span class="line">					next = FILTER1;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">default</span>: next = IDLE;</span><br><span class="line">		<span class="keyword">endcase</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//state flip-flops(sequential)</span></span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(~Rst_n) state &lt;= IDLE;</span><br><span class="line">		<span class="keyword">else</span> state &lt;= next;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//output</span></span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(~Rst_n)</span><br><span class="line">			Key_state &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">case</span>(next)</span><br><span class="line">			IDLE: <span class="keyword">begin</span> </span><br><span class="line">				en_cnt &lt;= <span class="number">1&#x27;b0</span>;		<span class="comment">//IDLE状态下计数器不计数</span></span><br><span class="line">				Key_state &lt;= <span class="number">1&#x27;b1</span>;	<span class="comment">//此时Key未被按下</span></span><br><span class="line">				Key_flag &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			FILTER0: <span class="keyword">begin</span></span><br><span class="line">				en_cnt &lt;= <span class="number">1&#x27;b1</span>;		<span class="comment">//FILTER0状态下计数器开始计数	</span></span><br><span class="line">				Key_state &lt;= <span class="number">1&#x27;b1</span>;	<span class="comment">//此时Key仍处于未被按下状态</span></span><br><span class="line">				Key_flag &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			DOWN: <span class="keyword">begin</span></span><br><span class="line">				en_cnt &lt;= <span class="number">1&#x27;b0</span>;		<span class="comment">//DOWN状态下计数器不计数	</span></span><br><span class="line">				Key_state &lt;= <span class="number">1&#x27;b0</span>;	<span class="comment">//此时Key已被按下</span></span><br><span class="line">				Key_flag &lt;= cnt_full;<span class="comment">//探测到Key被按下</span></span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			FILTER1: <span class="keyword">begin</span></span><br><span class="line">				en_cnt &lt;= <span class="number">1&#x27;b1</span>;		<span class="comment">//FILTER0状态下计数器开始计数	</span></span><br><span class="line">				Key_state &lt;= <span class="number">1&#x27;b0</span>;	<span class="comment">//此时Key仍处于被按下状态</span></span><br><span class="line">				Key_flag &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">default</span>: <span class="keyword">begin</span></span><br><span class="line">				en_cnt &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">				Key_state &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">				Key_flag &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">endcase</span></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//assign Key_flag = Key_negedge;	//组合逻辑输出方式来输出Key_flag</span></span><br><span class="line"><span class="keyword">endmodule</span> </span><br></pre></td></tr></table></figure>
<h2 id="Testbench"><a href="#Testbench" class="headerlink" title="Testbench"></a>Testbench</h2><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1 ns/ 1 ns</span></span><br><span class="line"><span class="meta">`<span class="keyword">define</span> clk_period 20</span></span><br><span class="line"><span class="keyword">module</span> key_filter_vlg_tst();</span><br><span class="line">	<span class="comment">// test vector input registers</span></span><br><span class="line">	<span class="keyword">reg</span> Clk;</span><br><span class="line">	<span class="keyword">reg</span> Key_in;</span><br><span class="line">	<span class="keyword">reg</span> Rst_n;</span><br><span class="line">	<span class="comment">// wires</span></span><br><span class="line">	<span class="keyword">wire</span> Key_flag;</span><br><span class="line">	<span class="keyword">wire</span> Key_state;</span><br><span class="line">									</span><br><span class="line">	key_filter i1 (</span><br><span class="line">	<span class="comment">// port map - connection between master ports and signals/registers</span></span><br><span class="line">		<span class="variable">.Clk</span>(Clk),</span><br><span class="line">		<span class="variable">.Key_flag</span>(Key_flag),</span><br><span class="line">		<span class="variable">.Key_in</span>(Key_in),</span><br><span class="line">		<span class="variable">.Key_state</span>(Key_state),</span><br><span class="line">		<span class="variable">.Rst_n</span>(Rst_n)</span><br><span class="line">	);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		Clk = <span class="number">1&#x27;b1</span>;</span><br><span class="line">		<span class="keyword">forever</span> <span class="variable">#(`clk_period/2)</span> Clk = ~Clk;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		Rst_n = <span class="number">1&#x27;b0</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;</span><br><span class="line">		<span class="variable">#(`clk_period*10)</span> Rst_n = <span class="number">1&#x27;b1</span>;</span><br><span class="line">		<span class="variable">#(`clk_period*10 + 1)</span>;</span><br><span class="line">		<span class="comment">//按下一次</span></span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">10000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">5_400_000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2600</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1300</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">200</span>;</span><br><span class="line">		</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">20_000_100</span>;</span><br><span class="line">		#<span class="number">10000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1400</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2600</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1300</span>;</span><br><span class="line">		</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">20_000_100</span>;</span><br><span class="line">		#<span class="number">10_000_000</span>;</span><br><span class="line">		<span class="comment">//second time</span></span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1400</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2600</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1300</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">200</span>;</span><br><span class="line">		</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">20_000_100</span>;</span><br><span class="line">		#<span class="number">10000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1400</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2600</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1300</span>;</span><br><span class="line">		</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">20_000_100</span>;</span><br><span class="line">		#<span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//third time</span></span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1400</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2600</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1300</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">200</span>;</span><br><span class="line">		</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">20_000_100</span>;</span><br><span class="line">		#<span class="number">10000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2000</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1400</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">2600</span>;</span><br><span class="line">		Key_in = <span class="number">1&#x27;b0</span>;#<span class="number">1300</span>;</span><br><span class="line">		</span><br><span class="line">		Key_in = <span class="number">1&#x27;b1</span>;#<span class="number">20_000_100</span>;</span><br><span class="line">		#<span class="number">10000</span>;</span><br><span class="line">		<span class="built_in">$stop</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span> </span><br></pre></td></tr></table></figure>
<h1 id="仿真模型"><a href="#仿真模型" class="headerlink" title="仿真模型"></a>仿真模型</h1><h2 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h2><p>$random默认是32位的随机数，根据自己的需要来取余计算<br>例如：需要0 ~ 65535的随机数，则可</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">reg</span>	[<span class="number">15</span>:<span class="number">0</span>] myrand;</span><br><span class="line"><span class="keyword">initial</span> myrand = &#123;<span class="built_in">$random</span>&#125;%<span class="number">65536</span>;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/15/FPGA-3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/14/FPGA-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/14/FPGA-2/" class="post-title-link" itemprop="url">学习FPGA（二）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-14 09:38:13" itemprop="dateCreated datePublished" datetime="2022-04-14T09:38:13+08:00">2022-04-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-22 19:29:44" itemprop="dateModified" datetime="2022-04-22T19:29:44+08:00">2022-04-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="有限状态机"><a href="#有限状态机" class="headerlink" title="有限状态机"></a>有限状态机</h1><p>状态的表示常用编码方法有二进制码、格雷码（Gray code）、独热码（one-hot code）。</p>
<h2 id="二进制码"><a href="#二进制码" class="headerlink" title="二进制码"></a>二进制码</h2><p>即用二进制计数</p>
<p>优点：属于压缩状态编码，状态机所需的状态向量位数较少；</p>
<p>缺点：1、译码复杂；2、相邻状态变换时，会有多位发生改变，电噪声大、转换速度较慢、易出错；（实际电路中多位改变很难做到完全同时发生）；</p>
<h2 id="格雷码（Gray-code）"><a href="#格雷码（Gray-code）" class="headerlink" title="格雷码（Gray code）"></a>格雷码（Gray code）</h2><p>在一组数的编码中，任意两个相邻的代码只有一位二进制数不同，且最大数与最小数之间也仅有一位数不同<br>构造方法：<br>1位格雷码有两个码字<br>(n+1)位格雷码中的前2n个码字等于n位格雷码的码字，按顺序书写，加前缀0<br>(n+1)位格雷码中的后2n个码字等于n位格雷码的码字，按逆序书写，加前缀1<br>n+1位格雷码的集合 &#x3D; n位格雷码集合(顺序)加前缀0 + n位格雷码集合(逆序)加前缀1<br>如：二进制码：000-001-010-011-100-101-110-111 相应的格雷码：000-001-011-010-110-111-101<br>    优点：1、属于压缩状态编码，状态机所需的状态向量位数较少；2、相邻状态变换时，仅有一位发生改变，电噪声小、转换速度较快；<br>    缺点：1、译码复杂；2、是一种变权码，每一位码没有固定的大小，难以直接比较大小和算术运算；</p>
<h2 id="独热码（one-hot-code）"><a href="#独热码（one-hot-code）" class="headerlink" title="独热码（one-hot code）"></a>独热码（one-hot code）</h2><p>有多少个状态就有多少个比特，其中有且只有一个比特为1，其余为0<br>用独热码表示三个状态可以写为：001，010，100</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/14/FPGA-2/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/13/FPGA-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Clover">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Clover's blog">
      <meta itemprop="description" content="这个少年还在迷茫...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Clover's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/04/13/FPGA-1/" class="post-title-link" itemprop="url">学习FPGA（一）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-04-13 16:50:46" itemprop="dateCreated datePublished" datetime="2022-04-13T16:50:46+08:00">2022-04-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-04-22 19:37:40" itemprop="dateModified" datetime="2022-04-22T19:37:40+08:00">2022-04-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>刚好今天尝试使用hexo框架搭建了个人博客，索性记录一下自己学习FPGA的过程，方便日后查看和复习。</p>
<h2 id="BCD计数器设计与验证"><a href="#BCD计数器设计与验证" class="headerlink" title="BCD计数器设计与验证"></a>BCD计数器设计与验证</h2><p>目的是通过将三个BCD计数器级联来实现1000的计数<br>单个BCD计数器的Verilog代码如下：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> bcd_counter(Clk, Cin, Rst_n, Cout, Q);</span><br><span class="line">	<span class="keyword">input</span> Clk;<span class="comment">//时间基准信号</span></span><br><span class="line">	<span class="keyword">input</span> Cin;<span class="comment">//计数器进位输入</span></span><br><span class="line">	<span class="keyword">input</span> Rst_n;<span class="comment">//计数器复位输入</span></span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> Cout;<span class="comment">//计数器进位输出</span></span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] Q;<span class="comment">//计数器计数输出</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//产生输出进位信号</span></span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(Rst_n==<span class="number">1&#x27;b0</span>) Cout = <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(Q==<span class="number">4&#x27;d9</span> &amp;&amp; Cin==<span class="number">1&#x27;b1</span>) Cout = <span class="number">1&#x27;b1</span>;	<span class="comment">//此处的进位设置并不合理，级联后会发生错误</span></span><br><span class="line">		<span class="keyword">else</span> Cout = <span class="number">1&#x27;b0</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//执行计数过程</span></span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> Clk <span class="keyword">or</span> <span class="keyword">negedge</span> Rst_n) <span class="keyword">begin</span></span><br><span class="line">		<span class="keyword">if</span>(Rst_n==<span class="number">1&#x27;b0</span>) Q &lt;= <span class="number">4&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(Cin==<span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">if</span>(Q==<span class="number">4&#x27;d9</span>)Q &lt;= <span class="number">4&#x27;b0</span>;</span><br><span class="line">			<span class="keyword">else</span> Q &lt;= Q + <span class="number">1&#x27;b1</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">else</span> Q &lt;= Q;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>

<p>使用modelsim分析时，先从sim中把子模块的输入输出信号全部添加到波形窗口中然后在波形窗口中选中所有信号（Ctrl+a），再按下快捷键Ctrl+g，完成按模块分组</p>
<p>将”&#x2F;&#x2F;产生输出进位信号”部分修改为：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span>@(*) <span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span>(Rst_n==<span class="number">1&#x27;b0</span>) Cout = <span class="number">1&#x27;b0</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(Q==<span class="number">4&#x27;d9</span> &amp;&amp; Cin==<span class="number">1&#x27;b1</span>) Cout = <span class="number">1&#x27;b1</span>;</span><br><span class="line">	<span class="keyword">else</span> Cout = <span class="number">1&#x27;b0</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>此即行为级建模实现的组合逻辑，但仿真的结果出现了奇怪的毛刺，这是rtl级仿真不该出现的</p>
<p>于是再将其改为：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assign</span> Cout = (Q==<span class="number">4&#x27;d9</span> &amp;&amp; Cin==<span class="number">1&#x27;b1</span>);</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/04/13/FPGA-1/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Clover</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  





</body>
</html>
